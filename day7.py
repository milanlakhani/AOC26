def number_of_beams(diagram):
    processed_diagram = diagram.split("\n")
    splits = 0
    start = processed_diagram[0].index("S")
    beams = [start]
    for line in processed_diagram:
        old_beams = beams
        new_beams = []
        for beam in old_beams:
            if line[beam] == "^":
                splits += 1
                if beam-1 not in new_beams:
                    new_beams.append(beam-1)
                new_beams.append(beam+1)
            elif beam not in new_beams:
                new_beams.append(beam)
        beams = new_beams
    return splits

def number_of_timelines(diagram):
    processed_diagram = diagram.split("\n")
    start = processed_diagram[0].index("S")
    beams = {str(start):1}
    for line in processed_diagram:
        old_beams = beams
        new_beams = {}
        for beam, volume in old_beams.items():
            beam_pos = int(beam)
            if line[beam_pos] == "^":
                if str(beam_pos-1) not in new_beams.keys():
                    new_beams[str(beam_pos-1)] = volume
                else:
                    new_beams[str(beam_pos-1)] += volume
                new_beams[str(beam_pos+1)] = volume
            elif beam not in new_beams.keys():
                new_beams[beam] = volume
            else:
                new_beams[beam] += volume
        beams = new_beams
    return sum(beams.values())

diagram = """......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^.^.^.^...................................................................
.............................................................................................................................................
..................................................................^.^...^.^..................................................................
.............................................................................................................................................
.................................................................^.^.^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.....^.....^................................................................
.............................................................................................................................................
...............................................................^.^.^.......^.^...............................................................
.............................................................................................................................................
..............................................................^...^.^.^...^.^.^..............................................................
.............................................................................................................................................
.............................................................^.^.^.....^.^...^.^.............................................................
.............................................................................................................................................
............................................................^.........^.^.^.^...^............................................................
.............................................................................................................................................
...........................................................^.^.^...^...^...^.^...^...........................................................
.............................................................................................................................................
..........................................................^.^.^.^.^.^.....^...^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^.....^.^.^.....^.......^.........................................................
.............................................................................................................................................
........................................................^.........^.^.^.^.^.^...^.^.^........................................................
.............................................................................................................................................
.......................................................^.....^.^.^...^.^.......^.....^.......................................................
.............................................................................................................................................
......................................................^...^.^.^.^.^.^.^.^.^.....^...^.^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.^.^.^.^.^...............^.^.....................................................
.............................................................................................................................................
....................................................^.^.^.^.......^...^.^.^.^.^.^.....^.^....................................................
.............................................................................................................................................
...................................................^.^.....^.^.^.^.....^.^.^.^.^.^.^.^...^...................................................
.............................................................................................................................................
..................................................^.^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^...^..................................................
.............................................................................................................................................
.................................................^.^.^...^.....^.....^...^.^.^...^.......^.^.................................................
.............................................................................................................................................
................................................^...^.^.^...^.^.^.....^.^.^.^.^.^.....^.^...^................................................
.............................................................................................................................................
...............................................^.^.^.^.....^.....^...^.^.^.^.^...^.^.^.^...^.^...............................................
.............................................................................................................................................
..............................................^...^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^.......^.^.^..............................................
.............................................................................................................................................
.............................................^.^...^.^.^.^...^...^.^...^.^...........^...^.^.^.^.............................................
.............................................................................................................................................
............................................^.^...^.^...^.^...^.^.^.^.....^.^.^.^.^...^.^.^...^.^............................................
.............................................................................................................................................
...........................................^.^.^.....^.^.^.^.^.......^.....^.^.^.^.^.^.....^.....^...........................................
.............................................................................................................................................
..........................................^.^.^.....^.^...^.^.^.^.....^.^.^.....^.^.....^.....^.^.^..........................................
.............................................................................................................................................
.........................................^.^.^.^...^.^.^.^...^.....^.^...^.....^.^.^.^.^.^.^...^.^.^.........................................
.............................................................................................................................................
........................................^.......^.^.^.^.^.^.^...^...^.^.^.....^...^...^.^.......^.^.^........................................
.............................................................................................................................................
.......................................^...^...^.^.....^.^...^.^...^.^.^.^...^.^.^.^.^...^.^.^...^...^.......................................
.............................................................................................................................................
......................................^.^.^...^.^.....^.^...^.^.....^.^...^...^.^.^.^...^.^.^...^.^...^......................................
.............................................................................................................................................
.....................................^.^.^...^.^.^.^.^...^.^.^.^.....^...^.......^.^.^.^.^.^.^.^...^...^.....................................
.............................................................................................................................................
....................................^...^.....^.^.^.^.^.^.^.^.....^.^...^.^.^.^...^.^.^.....^.^.....^.^.^....................................
.............................................................................................................................................
...................................^...^.^.^.^.^.^.....^...^...^.^.^...^.^.^.....^.....^.^.^...^.^.^.^.^.^...................................
.............................................................................................................................................
..................................^.^.^.......^.^.^...^...^.^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^.^..................................
.............................................................................................................................................
.................................^.....^.^.^.^.^.^.....^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.....^.^.....^...^.................................
.............................................................................................................................................
................................^.^.^...^.....^.^.^.^...^.^.^...^.....^.^.^.^.^.^.^...^.^.^.^...^.^.......^.^................................
.............................................................................................................................................
...............................^...^.^.^.^.^.....^.^.....^.....^.^.....^.......^.^.^.........^.^...^.^.^...^.^...............................
.............................................................................................................................................
..............................^.^.^.^.....^.^...^.^...^.^.....^.^.^.^.^.^...^...^.....^.^.^.^.^.^.^...^.^.^...^..............................
.............................................................................................................................................
.............................^...^.^.^.^.^.^...^.^.^.^.^.^.^.....^.^.^...^...^.^...^.^.^...^.^...^...^.^...^...^.............................
.............................................................................................................................................
............................^.^...^.......^.^.^...^.....^.....^.^.^.........^.^.^.^.^...^.^...^.^...^.^...^...^.^............................
.............................................................................................................................................
...........................^.......^.^.^.^.^.......^...^.^.......^.^...^.^.^.^...^.^.^.^.^.^...^.^...^.^...^.^.^.^...........................
.............................................................................................................................................
..........................^.^.^.....^.^.^.^.^...^.......^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.^.....^.^.........^...^..........................
.............................................................................................................................................
.........................^.^...^.^.^.^.^.^.^...^.^...^...^...^...^.^...^...^.^.^.^.^...^...^...^...^.^.^.^...^.^...^.........................
.............................................................................................................................................
........................^.^.....^.^...^...^...^.^...^.^...^.^.^.^...^.^.^.^.^...^.^...^.^...^.^.^.^...^.^...^.^.^.^.^........................
.............................................................................................................................................
.......................^...^...^.......^.^.^.^.^.............^.^.^.^.^.^.^.^.^.^.^...^.^...^.....^.^.......^.^...^.^.^.......................
.............................................................................................................................................
......................^.^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^...^...^.^.^.^.^.....^...^...^.^.^.^.^.^.^...^.^......................
.............................................................................................................................................
.....................^.^...^.^.^.....^.^...^.^...^.^.^...^.^.^.^.^.^.^.^.^...^.....^.^.^.......^...^...^.....^.^...^.^.^.....................
.............................................................................................................................................
....................^.....^...^...^.^.^...^.^.^.^.^.^...^.^.^...^.^.....^.^.^.........^.^.^...^.^.^...^.^.^...^.^...^...^....................
.............................................................................................................................................
...................^.^.........^.^.......^.....^.^...^.^.^.^.^.....^.^.....^...^...^.^.^.^.^.^.^.^.....^...^.^...^.....^.^...................
.............................................................................................................................................
..................^.^...^.^.^...^...^.^...^.^...^.^...^.^.^.^...^.^.^.^.....^...^...^.^...^.^...^.^.^...^.....^...^...^...^..................
.............................................................................................................................................
.................^.^.^.^.^.^.........^...^.^.^...^.^.......^.^...^.....^.^...^.^.^.^.^.^.^...^.........^.^.^...^.^.^.....^.^.................
.............................................................................................................................................
................^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.^................
.............................................................................................................................................
...............^.....^.^...^.^.^.^.^...^.^.^.^.....^.^.^...^.^.....^.^.^.^.^.^.^.^.^.....^.^.^.^.^.^.......^.^.^.^.^.........^...............
.............................................................................................................................................
..............^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^...^.^.^...^.^.^.^...^...^.^.^...^.^.^.^..............
.............................................................................................................................................
.............^.^.^.^.^.^.....^.^.^.^.^.^...^...^.^.^...^.^...^...^...^.^.^.^...^.^...^.....^.^.^.^.^.^...^.^.^.....^.^.^.^.^...^.............
.............................................................................................................................................
............^...^.^.......^.....^.^...^.......^.^...^.^.^.^...^.^.^.^.......^.^.^.^.^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^............
.............................................................................................................................................
...........^.^...^.^.^...^.^.^.....^.....^.^...^...^.^.^...^...^.^.^...^...^...^...^.^...^.^.^.^...^.^...^...^.^.^.^.^.^.^.......^...........
.............................................................................................................................................
..........^.^.^.^.^.^.^.^...^...^.^...^...^.^...^...^...^...^.^.......^...^.^.^.....^.^.^...^...^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^..........
.............................................................................................................................................
.........^.^.^.^.^.^.^.......^...^.^.^.^...^.^...^.^...^.^...^...^...^.....^.....^.^...^.^.^.^...^.^...^.^.^.^.....^.^.^.^.^.....^.^.........
.............................................................................................................................................
........^.^...^.^.^.^.....^.^...^.^.^...^...^.^.^.........^.^.....^.^.^.^.^.^.^.^.^.^...........^...^.....^.....^.^...^.^.^.^.^...^.^........
.............................................................................................................................................
.......^...^...^.^.........^.....^.^.^.^.^.^.^...^...^.^.^.^.....^.^.^.....^.^.^.....^.^.^.^.^...^...^.^.^.....^.^...^.^.^.^.....^.^.^.......
.............................................................................................................................................
......^...^...^.^...^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.......^.^.^.^...^.^.^.^.^.^.^...^...^.^...^.^.....^......
.............................................................................................................................................
.....^.^.^.^...^.....^...^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.^...^.^...^.^.^...^...^.^.^.^.....^.^...^.^.^.^.^.^...^...^.......^.^.....
.............................................................................................................................................
....^.^.^...^.^...^...^.^...^.^...^.^...^.^.....^.....^.^.^.^...^.^.^.....^.^.^...^.^.^...^.....^.^.^.^...^.^...^.....^.^.^.^.^.^...^.^.^....
.............................................................................................................................................
...^...^.^.....^.^.^.^.......^.^.^.....^.^...^.^.^.^.^.^...^.^.^...^.^.....^...^.^...^...^.....^.^...^...^...^...^...^...^.^...^.^.^.....^...
.............................................................................................................................................
..^...........^.^.^.^...^.^.^.....^.........^.^.^.^...^...^.....^.^...^.......^.^.^.^.^.^...^.^...^...^.^.^.^.^...^.^.^.....^.^.^...^.^.^.^..
.............................................................................................................................................
.^.....^.....^.^...^.^.............^.^.^.^...^...^.^.^.^...^.^.....^...^.^.^.^...^.......^...^.^.^.......^.....^.^.^.....^.........^...^.^.^.
............................................................................................................................................."""

print(number_of_beams(diagram))
print(number_of_timelines(diagram))